### Класс Shop
- **Пространство имен**: `Neo.Shop`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Shop/Shop.cs`

**Краткое описание**:
`Shop` — это основной класс для управления логикой магазина. Он отвечает за загрузку данных о товарах, обработку покупок, выбор предметов и обновление их визуального состояния.

**Ключевые особенности**:
- **Автоматическое создание элементов**: Может автоматически создавать (`спавнить`) визуальные элементы товаров на сцене, если их не хватает. Для этого используются поля `_prefab` (шаблон элемента) и `_container` (родительский объект для новых элементов).
- **Динамическая загрузка цен**: Цены могут быть загружены из `PlayerPrefs` или использоваться из `ShopItemData`.
- **Гибкая настройка товаров**: Товары задаются через массив `ShopItemData`.
- **Интеграция с системой денег**: Взаимодействует с `IMoneySpend` для списания средств.
- **Сохранение прогресса**: Сохраняет измененные цены (например, после одноразовой покупки) и последний экипированный товар в `PlayerPrefs`.
- **События**: Предоставляет `UnityEvent` для отслеживания ключевых действий: выбор, покупка, ошибка покупки.

**Публичные свойства и поля**:
- `Prices`: `int[]` - Массив актуальных цен на товары. Только для чтения.
- `ShopItemDatas`: `ShopItemData[]` - Массив ассетов с данными о товарах. Только для чтения.
- `PreviewId`: `int` - ID товара, который в данный момент отображается в превью. Только для чтения.
- `Id`: `int` - ID текущего выбранного товара. При установке этого значения вызывается метод `Select()` для выбора нового товара.

**Сериализуемые настройки (Inspector)**
- `_keySave`: `string` — базовый ключ сохранения цен в `PlayerPrefs` (по умолчанию `"Shop"`).
- `_keySaveEquipped`: `string` — ключ для сохранения последнего экипированного товара (по умолчанию `"ShopEquipped"`).
- `_changePreviewOnPurchaseFailed`: `bool` — если `true`, при неудачной покупке (недостаточно денег) превью переключается на товар покупки; если `false` — превью не меняется. По умолчанию `false`.

**Публичные методы**:
- `ShowPreview(int id)`: Отображает превью товара с указанным `id` без его выбора.
- `Buy()`: Пытается купить товар, который в данный момент выбран в превью (`PreviewId`).
- `Buy(int id)`: Пытается купить товар с указанным `id`. Если цена 0, товар просто выбирается. В случае успеха вызывает событие `OnPurchased`. Поведение превью при неудачной покупке контролируется флагом `_changePreviewOnPurchaseFailed`.

**Жизненный цикл**
- При запуске: загружаются цены и последний экипированный индекс, создаются недостающие элементы, отображается превью сохраненного индекса, выполняется визуализация и выбирается сохраненный товар (если включен `_useSetItem`).
- `Visual()`: Обновляет визуальное отображение всех товаров в магазине.

**Unity Events**:
- `OnSelect`: Вызывается при выборе товара. Передает `int` (id выбранного товара).
- `OnPurchased`: Вызывается при успешной покупке товара. Передает `int` (id купленного товара).
- `OnPurchaseFailed`: Вызывается при неудачной попытке покупки (недостаточно средств). Передает `int` (id товара, который не удалось купить).
- `OnLoad`: Вызывается после загрузки данных магазина из `PlayerPrefs`.
