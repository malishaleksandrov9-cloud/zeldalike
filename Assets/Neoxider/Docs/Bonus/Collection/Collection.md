### Класс Collection
- **Пространство имен**: `Neo.Bonus`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Bonus/Collection/Collection.cs`

**Краткое описание**:
`Collection` — это главный класс-синглтон, который управляет логикой получения и хранения коллекционных предметов. Он отвечает за загрузку прогресса, выдачу новых призов и сохранение состояния коллекции. Наследуется от `Singleton<Collection>` для обеспечения единственного экземпляра в сцене.

**Ключевые особенности**:
- **Синглтон**: Обеспечивает глобальный доступ к состоянию коллекции через `Collection.I` (наследуется от `Singleton<Collection>`).
- **Сохранение и загрузка**: Автоматически сохраняет и загружает данные о собранных предметах с помощью `PlayerPrefs`.
- **Выдача призов**: Содержит логику для получения нового, еще не собранного предмета. Может выдавать как случайный предмет, так и первый по списку.
- **Работа через код**: Полный API для программного управления коллекцией (добавление, удаление, проверка предметов).

**Публичные свойства**:
- `I`: `static Collection` - Глобальная статическая ссылка на экземпляр класса (через `Singleton<T>`).
- `IsInitialized`: `static bool` - Проверка инициализации синглтона.
- `SaveKeyPrefix`: `string` - Префикс ключа для сохранения в `PlayerPrefs`. По умолчанию `"Collection_"`. Позволяет создавать несколько независимых коллекций.
- `RandomPrize`: `bool` - Если `true`, метод `GetPrize()` будет выдавать случайный предмет из еще не собранных. Если `false` — первый по списку.
- `ItemCollectionDatas`: `ItemCollectionData[]` - Массив всех `ScriptableObject`'ов, представляющих возможные предметы в коллекции.
- `EnabledItems`: `bool[]` (read-only) - Массив, показывающий, какие предметы уже собраны (`true`) или еще нет (`false`).
- `ItemCount`: `int` - Общее количество предметов в коллекции.
- `UnlockedCount`: `int` - Количество разблокированных предметов.
- `LockedCount`: `int` - Количество заблокированных предметов.

**Публичные методы**:
- `Load()`: Загружает состояние коллекции из `PlayerPrefs`. Вызывается автоматически при инициализации. Использует `SaveKeyPrefix` для формирования ключей сохранения.
- `Save()`: Явно сохраняет текущее состояние коллекции в `PlayerPrefs`. Обычно вызывается автоматически при изменении, но можно вызвать вручную для принудительного сохранения.
- `GetPrize()`: Пытается получить новый, еще не собранный предмет. Возвращает `ItemCollectionData` полученного предмета или `null`, если все предметы уже собраны.
- `HasItem(int id)`: Проверяет, собран ли предмет с указанным ID. Возвращает `true`, если предмет разблокирован.
- `AddItem(int id)`: Добавляет предмет в коллекцию по ID. Автоматически сохраняет в `PlayerPrefs` и вызывает события.
- `RemoveItem(int id)`: Удаляет предмет из коллекции по ID. Автоматически сохраняет в `PlayerPrefs` и вызывает события.
- `SetItemEnabled(int id, bool enabled)`: Устанавливает состояние предмета (разблокирован/заблокирован).
- `ClearCollection()`: Очищает всю коллекцию (блокирует все предметы).
- `UnlockAllItems()`: Разблокирует все предметы в коллекции.
- `GetItemData(int id)`: Возвращает данные предмета (`ItemCollectionData`) по ID или `null`, если ID невалиден.

**Unity Events**:
- `OnGetItem`: `UnityEvent<int>` - Вызывается при получении нового предмета через `GetPrize()`. Передает `int` (ID полученного предмета).
- `OnLoadItems`: `UnityEvent` - Вызывается после загрузки состояния коллекции из `PlayerPrefs`.
- `OnItemAdded`: `UnityEvent<int>` - Вызывается при добавлении предмета в коллекцию (через `AddItem()`). Передает `int` (ID добавленного предмета).
- `OnItemRemoved`: `UnityEvent<int>` - Вызывается при удалении предмета из коллекции (через `RemoveItem()`). Передает `int` (ID удаленного предмета).

**Система сохранения**:
Коллекция использует `PlayerPrefs` для сохранения состояния предметов. Ключи формируются по шаблону: `{SaveKeyPrefix}Item_{id}`.

**Пример:** Если `SaveKeyPrefix = "Collection_"`, то предмет с ID 0 будет сохранен как `"Collection_Item_0"`.

**Поддержка нескольких коллекций**:
Для создания нескольких независимых коллекций можно использовать разные префиксы:

```csharp
// Основная коллекция (по умолчанию)
Collection.I.SaveKeyPrefix = "Collection_";

// Дополнительная коллекция скинов
Collection.I.SaveKeyPrefix = "Skins_";

// Коллекция достижений
Collection.I.SaveKeyPrefix = "Achievements_";
```

**Важно:** При изменении `SaveKeyPrefix` нужно вызвать `Load()` для загрузки данных с новым префиксом, или `Save()` для сохранения текущих данных с новым префиксом.

**Примеры использования**:
```csharp
// Проверка наличия предмета
if (Collection.I.HasItem(0))
{
    Debug.Log("Предмет 0 уже собран!");
}

// Добавление предмета вручную
Collection.I.AddItem(5);

// Получение данных предмета
var itemData = Collection.I.GetItemData(3);

// Получение статистики
Debug.Log($"Всего: {Collection.I.ItemCount}, Разблокировано: {Collection.I.UnlockedCount}");

// Подписка на события
Collection.I.OnItemAdded.AddListener((id) => {
    Debug.Log($"Предмет {id} добавлен в коллекцию!");
});

// Явное сохранение
Collection.I.Save();

// Работа с разными коллекциями
Collection.I.SaveKeyPrefix = "Skins_";
Collection.I.Load(); // Загружаем коллекцию скинов
```
