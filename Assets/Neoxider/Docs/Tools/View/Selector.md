# Компонент Selector

## 1. Введение

`Selector` — это универсальный компонент для управления выбором элементов из списка. Он позволяет легко переключаться между различными опциями, будь то вкладки UI, выбор персонажа, элементы инвентаря или узлы в дереве навыков.

Компонент очень гибок: он может работать как с реальными `GameObject` (активируя/деактивируя их), так и с виртуальным количеством элементов, просто отслеживая индекс. Он также поддерживает зацикливание и уникальный режим "заполнения", который активирует все элементы до текущего индекса.

---

## 2. Описание класса

### Selector
- **Пространство имен**: `Neo.Tools`
- **Путь к файлу**: `Assets/Neoxider/Scripts/Tools/View/Selector.cs`

**Описание**
Компонент, который управляет текущим индексом выбора и соответствующим образом активирует/деактивирует `GameObject` из своего списка или просто вызывает события, передавая текущий индекс.

**Ключевые поля**

### Источник элементов
- `_items` (`GameObject[]`): Массив `GameObject`, которые будут управляться селектором. Если этот массив заполнен, селектор будет активировать/деактивировать объекты.
- `_count` (`int`): Если `_items` пуст, селектор будет работать с этим числом как с виртуальным количеством элементов. Полезно, когда вам нужен только индекс, а не управление `GameObject`.
- `_setChild` (`bool`): Если `true`, компонент автоматически заполнит массив `_items` всеми дочерними `GameObject` своего объекта.

### Настройки поведения
- `_loop` (`bool`): Если `true`, при достижении конца списка селектор вернется в начало, и наоборот.
- `_allowEmptyEffectiveIndex` (`bool`, по умолчанию `false`): Разрешить ли эффективному индексу быть `-1` (ничего не выбрано). Полезно для скинов/"пустого" состояния. Влияет на границы индекса с учетом `_indexOffset`.
- `_fillMode` (`bool`): **Важная настройка!**
  - Если `false` (по умолчанию): Только один элемент в списке будет активен (тот, который соответствует `_currentIndex`).
  - Если `true`: Все элементы от начала списка до `_currentIndex` (включительно) будут активны. Идеально для индикаторов прогресса, звезд рейтинга или разблокировки навыков.
- `_indexOffset` (`int`): Смещение, которое добавляется к `_currentIndex` при отображении или использовании. Полезно, если вы хотите, чтобы первый элемент отображался как "1" вместо "0".

**Публичные методы (Public Methods)**
- `Next()`: Переключает выбор на следующий элемент.
- `Previous()`: Переключает выбор на предыдущий элемент.
- `Set(int index)`: Устанавливает выбор на конкретный индекс.
- `SetFirst()`: Устанавливает выбор на первый элемент (индекс 0).
- `SetLast()`: Устанавливает выбор на последний элемент.
- `ToggleFillMode()`: Переключает режим `_fillMode`.
- `Reset()`: Сбрасывает выбор на начальный индекс (по умолчанию 0).
- `ToggleIndex(int index, bool? state = null)`: Активирует/деактивирует `GameObject` по указанному индексу (с учетом `_indexOffset`).

**Unity Events**
- `OnSelectionChanged` (`UnityEvent<int>`): Вызывается каждый раз, когда текущий выбор меняется. Передает новый индекс.
- `OnFinished`: Вызывается, когда селектор достигает конца списка (только если `_loop` выключен).

---

## 3. Как использовать

### 3.1. Управление GameObjects
1.  Создайте пустой `GameObject` (например, `TabSelector`).
2.  Сделайте ваши вкладки UI (или другие `GameObject`) дочерними по отношению к `TabSelector`.
3.  Добавьте компонент `Selector` на `TabSelector`.
4.  В инспекторе `Selector` включите `_setChild` (он автоматически заполнит `_items`).
5.  Привяжите кнопки "Вперед" и "Назад" к методам `Next()` и `Previous()` компонента `Selector`.
6.  К событию `OnSelectionChanged` можно привязать логику, которая, например, обновляет текст заголовка вкладки.

### 3.2. Режим "Заполнение" (Fill Mode)
1.  Создайте 5 звезд-изображений и сделайте их дочерними к `StarContainer`.
2.  Добавьте `Selector` на `StarContainer`.
3.  Включите `_setChild` и `_fillMode`.
4.  Теперь, если вы вызовете `Selector.Set(2)`, то активируются звезды с индексом 0, 1 и 2.
5.  Чтобы значение 0 не активировало ни одной звезды, установите `_allowEmptyEffectiveIndex = true` и `_indexOffset = -1` — тогда `Value = 0` даст пустое состояние.

### 3.3. Виртуальный счетчик
1.  Добавьте `Selector` на любой `GameObject`.
2.  Вместо заполнения `_items`, установите `_count` в 5 (например).
3.  Теперь `Selector` будет отслеживать индекс от 0 до 4, вызывая `OnSelectionChanged` при каждом изменении.
